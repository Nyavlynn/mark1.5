<!-- templates/drivers/registration.html -->
{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h3 class="card-title">مرحبا بكم</h3>
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data" id="driverForm">
                        {% csrf_token %}
                        
                        <!-- Step 1: Basic Information -->
                        <div id="step1" class="form-section">
                            <h4>الخطوة الاولى: تقديم المعلومات</h4>
                            <div class="mb-3">
                                <label for="{{ form.phone_number.id_for_label }}" class="form-label">رقم الهاتف:</label>
                                {{ form.phone_number }}
                                {% if form.phone_number.errors %}
                                <div class="text-danger">{{ form.phone_number.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                <label for="{{ form.city.id_for_label }}" class="form-label">المحافظة:</label>
                                {{ form.city }}
                                {% if form.city.errors %}
                                <div class="text-danger">{{ form.city.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                <label for="{{ form.status.id_for_label }}" class="form-label">الحالة:</label>
                                {{ form.status }}
                                {% if form.status.errors %}
                                <div class="text-danger">{{ form.status.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <button type="button" id="nextBtn" class="btn btn-primary">تقديم</button>
                        </div>
                        
                        <!-- Step 2: Document Upload -->
                        <div id="step2" class="form-section" style="display: none;">
                            <h4>الخطوة الثانية : تقديم المستمسكات</h4>
                            
                            <div class="mb-3">
                                <label for="{{ form.id_document.id_for_label }}" class="form-label">فيديو للهوية:</label>
                                {{ form.id_document }}
                                {% if form.id_document.errors %}
                                <div class="text-danger">{{ form.id_document.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                <label for="{{ form.car_info_document.id_for_label }}" class="form-label">فيديو للسنوية:</label>
                                {{ form.car_info_document }}
                                {% if form.car_info_document.errors %}
                                <div class="text-danger">{{ form.car_info_document.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                <label for="{{ form.car_video.id_for_label }}" class="form-label">فيديو للسيارة:</label>
                                {{ form.car_video }}
                                {% if form.car_video.errors %}
                                <div class="text-danger">{{ form.car_video.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                <label for="{{ form.personal_photo.id_for_label }}" class="form-label">صورة شخصية:</label>
                                {{ form.personal_photo }}
                                {% if form.personal_photo.errors %}
                                <div class="text-danger">{{ form.personal_photo.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3 form-check">
                                <input type="checkbox" class="form-check-input" id="carNotOwned" name="car_not_owned">
                                <label class="form-check-label" for="carNotOwned">السيارة مو باسمي</label>
                            </div>
                            
                            <div id="additionalDocDiv" class="mb-3" style="display: none;">
                                <label for="{{ form.additional_document.id_for_label }}" class="form-label">عقد مروري او مكاتبة او وكالة:</label>
                                {{ form.additional_document }}
                                {% if form.additional_document.errors %}
                                <div class="text-danger">{{ form.additional_document.errors }}</div>
                                {% endif %}
                            </div>
                            
                            <button type="button" id="backBtn" class="btn btn-secondary">Back</button>
                            <button type="submit" class="btn btn-success">Submit Registration</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Step navigation
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const nextBtn = document.getElementById('nextBtn');
        const backBtn = document.getElementById('backBtn');
        
        // Show additional document based on checkbox
        const carNotOwned = document.getElementById('carNotOwned');
        const additionalDocDiv = document.getElementById('additionalDocDiv');
        
        // Next button click handler
        nextBtn.addEventListener('click', function() {
            // Get form values
            const phoneNumber = document.getElementById('{{ form.phone_number.id_for_label }}').value;
            const city = document.getElementById('{{ form.city.id_for_label }}').value;
            const status = document.getElementById('{{ form.status.id_for_label }}').value;
            
            // Validate first step
            if (!phoneNumber || !city || !status) {
                alert('Please fill in all the fields before proceeding.');
                return;
            }
            
            // Show step 2
            step1.style.display = 'none';
            step2.style.display = 'block';
        });
        
        // Back button click handler
        backBtn.addEventListener('click', function() {
            step2.style.display = 'none';
            step1.style.display = 'block';
        });
        
        // Car ownership checkbox handler
        carNotOwned.addEventListener('change', function() {
            additionalDocDiv.style.display = this.checked ? 'block' : 'none';
        });
    });
</script>
{% endblock %}

////python manage.py runserver 8000
